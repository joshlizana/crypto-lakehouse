# Spark configuration for Iceberg + Nessie + SeaweedFS

# Iceberg catalog configuration
spark.sql.extensions                          org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
spark.sql.catalog.nessie                      org.apache.iceberg.spark.SparkCatalog
spark.sql.catalog.nessie.type                 nessie
spark.sql.catalog.nessie.uri                  http://nessie:19120/api/v1
spark.sql.catalog.nessie.ref                  main
spark.sql.catalog.nessie.warehouse            s3a://warehouse/
spark.sql.catalog.nessie.io-impl              org.apache.iceberg.aws.s3.S3FileIO

# S3/SeaweedFS configuration
spark.hadoop.fs.s3a.endpoint                  http://seaweedfs-s3:8333
spark.hadoop.fs.s3a.access.key                admin
spark.hadoop.fs.s3a.secret.key                admin
spark.hadoop.fs.s3a.path.style.access         true
spark.hadoop.fs.s3a.impl                      org.apache.hadoop.fs.s3a.S3AFileSystem
spark.hadoop.fs.s3a.connection.ssl.enabled    false

# Iceberg defaults
spark.sql.defaultCatalog                      nessie

# Performance tuning
spark.sql.shuffle.partitions                  4
spark.default.parallelism                     4

# Streaming checkpoint location
spark.sql.streaming.checkpointLocation        s3a://checkpoints/

# Additional JARs (loaded via packages in submit)
spark.jars.packages                           org.apache.iceberg:iceberg-spark-runtime-3.5_2.12:1.4.3,org.projectnessie.nessie-integrations:nessie-spark-extensions-3.5_2.12:0.76.0,org.apache.iceberg:iceberg-aws-bundle:1.4.3,org.apache.spark:spark-sql-kafka-0-10_2.12:3.5.0
